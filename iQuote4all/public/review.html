<!doctype html>
<html>
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Review â€” MindShift Books</title>
  <style>
    body{font-family:Inter, system-ui, Arial; padding:22px; background:#f8fafc}
    .card{background:white;padding:18px;border-radius:12px;box-shadow:0 18px 40px rgba(0,0,0,0.06);max-width:900px;margin:12px auto}
    .cover{width:140px;height:200px;object-fit:cover;border-radius:8px}
    .reviews{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    .rev-img{width:120px;height:120px;object-fit:cover;border-radius:8px}
  </style>
</head>
<body>
  <div id="root"><div style="padding:20px">Loading...</div></div>

  <script>
    async function loadProduct() {
      const params = new URLSearchParams(location.search);
      const id = params.get('id');
      if (!id) return document.getElementById('root').innerHTML = '<div class="card">No product specified.</div>';

      try {
        const res = await fetch(`/api/product/${encodeURIComponent(id)}`);
        if (!res.ok) return document.getElementById('root').innerHTML = '<div class="card">Product not found.</div>';
        const j = await res.json();
        const prod = j.product;
        if (!prod) return document.getElementById('root').innerHTML = '<div class="card">Product not found.</div>';

        document.getElementById('root').innerHTML = `
          <div class="card">
            <div style="display:flex;gap:18px;align-items:flex-start">
              <img src="${prod.cover}" class="cover" />
              <div>
                <h2>${prod.title}</h2>
                <div style="font-weight:700;margin-top:6px;">$${Number(prod.priceUSD).toFixed(2)}</div>
                <div style="margin-top:8px;"><button onclick="window.history.back()">Back</button></div>
              </div>
            </div>

            <h3 style="margin-top:14px">Reviews</h3>
            <div class="reviews">
              ${ (prod.reviewImages || []).map(img => `<img src="${img}" class="rev-img"/>`).join('') }
            </div>
          </div>
        `;
      } catch (e) {
        console.error(e);
        document.getElementById('root').innerHTML = '<div class="card">Failed to load product.</div>';
      }
    }
    loadProduct();
  </script>
</body>
</html>
